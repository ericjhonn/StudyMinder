<Window x:Class="StudyMinder.Views.CustomMessageBoxWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:StudyMinder.Converters"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        xmlns:services="clr-namespace:StudyMinder.Services"
        xmlns:icon="clr-namespace:MahApps.Metro.IconPacks;assembly=MahApps.Metro.IconPacks.Material"
        Title="Mensagem"
        ResizeMode="NoResize"
        SizeToContent="Height"
        Width="450"
        WindowStartupLocation="CenterOwner"
        Background="#1E1E1E"
        Foreground="#FFFFFF"
        FontFamily="Segoe UI"
        FontSize="14"
        AllowsTransparency="False"
        ShowInTaskbar="False">

    <!-- WindowChrome para barra de título customizada -->
    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome CaptionHeight="32"
                            ResizeBorderThickness="5"
                            GlassFrameThickness="5"
                            CornerRadius="0"
                            UseAeroCaptionButtons="True" />
    </shell:WindowChrome.WindowChrome>

    <Window.Resources>
        <converters:MessageTypeToColorConverter x:Key="MessageTypeToColorConverter" />
        <converters:MessageTypeToIconConverter x:Key="MessageTypeToIconConverter" />
    </Window.Resources>

    <Border BorderBrush="#3F3F46"
            BorderThickness="1"
            Background="#1E1E1E">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- Barra de título -->
            <Border Grid.Row="0"
                    Background="{DynamicResource CardBrush}"
                    Padding="8,4"
                    BorderThickness="0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- Ícone -->
                    <TextBlock Grid.Column="0"
                               Text="{Binding MessageType, Converter={StaticResource MessageTypeToIconConverter}}"
                               FontSize="22"
                               Margin="0,0,10,0"
                               VerticalAlignment="Center"
                               Foreground="{Binding MessageType, Converter={StaticResource MessageTypeToColorConverter}}" />

                    <!-- Título -->
                    <TextBlock Grid.Column="1"
                               Text="{Binding Title}"
                               Style="{DynamicResource Title3Style}"
                               Margin="0"
                               TextTrimming="CharacterEllipsis" />

                    <!-- Botão Fechar -->
                    <Button Grid.Column="2"
                            x:Name="BtnFechar"
                            Style="{DynamicResource CloseButtonStyle}"
                            Click="BtnFechar_Click"
                            shell:WindowChrome.IsHitTestVisibleInChrome="True"
                            ToolTip="Fechar">
                        <icon:PackIconMaterial Kind="Close"
                                               Width="12" />

                    </Button>
                </Grid>
            </Border>

            <!-- Mensagem -->
            <Border Grid.Row="1"
                    Background="#1E1E1E"
                    Padding="20">
                <TextBlock Text="{Binding Message}"
                           TextWrapping="Wrap"
                           LineHeight="20"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Left" />
            </Border>

            <!-- Botões -->
            <Border Grid.Row="2"
                    Background="#1E1E1E"
                    Padding="20">
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Right">

                    <!-- OK -->
                    <Button x:Name="BtnOk"
                            Content="OK"
                            Width="90"
                            Height="32"
                            Click="BtnOk_Click"
                            IsDefault="True">
                        <Button.Style>
                            <Style TargetType="Button"
                                   BasedOn="{StaticResource ModernButtonStyle}">
                                <Setter Property="Visibility"
                                        Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Buttons}"
                                                 Value="{x:Static services:MessageBoxButtons.Ok}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Buttons}"
                                                 Value="{x:Static services:MessageBoxButtons.OkCancel}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <!-- Sim -->
                    <Button x:Name="BtnSim"
                            Content="Sim"
                            Width="90"
                            Height="32"
                            Margin="0,0,8,0"
                            Click="BtnSim_Click"
                            IsDefault="True">
                        <Button.Style>
                            <Style TargetType="Button"
                                   BasedOn="{StaticResource ModernButtonStyle}">
                                <Setter Property="Visibility"
                                        Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Buttons}"
                                                 Value="{x:Static services:MessageBoxButtons.YesNo}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Buttons}"
                                                 Value="{x:Static services:MessageBoxButtons.YesNoCancel}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <!-- Não -->
                    <Button x:Name="BtnNao"
                            Content="Não"
                            Width="90"
                            Height="32"
                            Click="BtnNao_Click">
                        <Button.Style>
                            <Style TargetType="Button"
                                   BasedOn="{StaticResource SecondaryButtonStyle}">
                                <Setter Property="Visibility"
                                        Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Buttons}"
                                                 Value="{x:Static services:MessageBoxButtons.YesNo}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Buttons}"
                                                 Value="{x:Static services:MessageBoxButtons.YesNoCancel}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <!-- Cancelar -->
                    <Button x:Name="BtnCancelar"
                            Content="Cancelar"
                            Width="90"
                            Height="32"
                            Click="BtnCancelar_Click">
                        <Button.Style>
                            <Style TargetType="Button"
                                   BasedOn="{StaticResource SecondaryButtonStyle}">
                                <Setter Property="Visibility"
                                        Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Buttons}"
                                                 Value="{x:Static services:MessageBoxButtons.OkCancel}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Buttons}"
                                                 Value="{x:Static services:MessageBoxButtons.YesNoCancel}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>
